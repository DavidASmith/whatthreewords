---
title: "Using whatthreewords"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Using whatthreewords}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

The `whatthreewords` package supports working with the [what3words](https://what3words.com/) API. what3words has partitioned the surface of the earth into 3m x 3m squares, each of which can be identified by three words. These are conventionally styled with three slashes at the beginning. For example, the peak of the Great Pyramid of Giza is located by the three words [///ballots.height.silks](https://what3words.com/ballots.height.silks).

You can use the package to determine the three word address for any coordinates, or return the coordinates for any valid three word combination. 

# Load the package

First, load the package...

```{r setup}
library(whatthreewords)
```

# Set environment variable

The what3words API requires a key for authentication. You can register for a key at [https://developer.what3words.com/public-api](https://developer.what3words.com/public-api).

You must then set the `WTW_API_KEY` environment variable to hold your key. For example...

```
Sys.setenv(WTW_API_KEY = "MYKEY")
```

You are now ready to use the package.

# Get a what3words address from coordinates

Use `words_from_coords` to get a what3words location for a given latitude and longitude.

```{r}
words_from_coords(lat = 51.5095, 
                  lon = -0.1266)
```

## Full details

By default, `words_from_coords` returns only the three words which represent the location. However, it's possible to return more information about the location by submitting `full_details = TRUE`.

```{r}
words_from_coords(lat = 51.5095, 
                  lon = -0.1266, 
                  full_details = TRUE)
```

## Multiple locations

`words_from_coords` is vectorised over the coordinates so you can return multiple locations with one call. For example, take the following data frame.

```{r}
locations <- data.frame(name = c("Sheffield United", "Sheffield Wednesday", "Sheffield Club"), 
                        lat = c(53.3703, 53.41145, 53.3096), 
                        lon = c(-1.47119, -1.500204, -1.478715))
locations
```

We can add the what3words for each row like this...

```{r}

locations$words <- words_from_coords(lat = locations$lat, 
                                     lon = locations$lon)

locations
```


# Get coordinates from a what3words location

```{r}
coords_from_words("hours.flesh.petal", full_details = FALSE)
```
## Full details

```{r}
coords_from_words("hours.flesh.petal", full_details = TRUE)
```

## Multiple locations

```{r}
coords_from_words(c("laughs.remind.fact", 
                    "hotdog.jumping.frog", 
                    "dream.helps.forget"), 
                  full_details = FALSE)
```

# Different languages

```{r}
words_from_coords(lat = 48.70913, 
                  lon = 9.001062, 
                  language = "de")
```
Available languages can be determined by

```{r}
get_available_languages() |> 
  head()
```

